1)
cygcheck -c -d|sed -e "1,2d" -e 's/ .*$//' > installedPackagesDate.txt

2)
see "./setup --help"
at
setup -P

Use commas to separate package names:

setup -M -P arg,ash,atk,...